{"version":3,"file":"static/js/198.104e4a50.chunk.js","mappings":"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","sources":["pages/CatalogBody/CatalogBody.styled.jsx","pages/CatalogBody/CatalogBody.jsx"],"sourcesContent":["import styled from \"@emotion/styled\";\nimport { Button } from \"@mui/material\";\n\nexport const Container = styled.div``;\n\nexport const LoadMoreButton = styled(Button)`\n  display: block;\n  border: none;\n  margin: 0 auto;\n  margin-bottom: 140px;\n  background-color: ${({ theme }) => theme.bgMain};\n  cursor: pointer;\n  padding: 10px 20px;\n  color: ${({ theme }) => theme.accentMain};\n  font-family: \"Manrope\";\n  font-size: 16px;\n  font-weight: 500;\n  line-height: calc(24 / 16);\n  text-decoration-line: underline;\n`;\n\nexport const PageLoaderContainer = styled.div`\n  height: 300px;\n  position: relative;\n`;\n","import * as S from './CatalogBody.styled';\nimport { useSearchParams } from 'react-router-dom';\nimport { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport { carsEndpoint, carsPerPage } from '../../constants';\nimport { CarsList } from '../../components';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { selectCurrentPage } from '../../redux/favoriteCars/carsSlice';\nimport { incrementCurrentPage } from '../../redux/favoriteCars/carsSlice';\nimport StyledLoader from '../../ui/StyledLoader/StyledLoader';\nimport { toast } from 'react-toastify';\n\nconst CatalogBody = () => {\n  const dispatch = useDispatch();\n  const currentPage = useSelector(selectCurrentPage);\n  const [searchParams] = useSearchParams();\n  const make = searchParams.get('make');\n  const rentalPrice = searchParams.get('rentalPrice');\n  const minMileage = searchParams.get('minMileage');\n  const maxMileage = searchParams.get('maxMileage');\n\n  const [isLoading, setIsLoading] = useState(false);\n  const [cars, setCars] = useState([]);\n  const [filteredCars, setFilteredCars] = useState([]);\n  const [isPageLast, setIsPageLast] = useState(true);\n  const isFirstRun = useRef(true);\n\n  useEffect(() => {\n    const filteredArray = filterArray(cars);\n\n    setFilteredCars(filteredArray);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [cars]);\n\n  const filterArray = arr => {\n    if (!rentalPrice && !minMileage && !maxMileage && arr.length === 0) {\n      return arr;\n    }\n    const filteredByRentalPrice = rentalPrice\n      ? arr.filter(\n          item =>\n            Number(item.rentalPrice.replace('$', '')) <= Number(rentalPrice)\n        )\n      : [...arr];\n\n    const filteredByMinMileage = minMileage\n      ? filteredByRentalPrice.filter(item => {\n          return Number(item.mileage) >= Number(minMileage);\n        })\n      : [...filteredByRentalPrice];\n\n    const filteredByMaxMileage = maxMileage\n      ? filteredByMinMileage.filter(\n          item => Number(item.mileage) <= Number(maxMileage)\n        )\n      : [...filteredByMinMileage];\n\n    return filteredByMaxMileage;\n  };\n\n  const fetchCarsData = async page => {\n    setIsLoading(true);\n    if (page === 1 || rentalPrice || minMileage || maxMileage) {\n      setCars([]);\n    }\n    try {\n      const response = await axios.get(\n        rentalPrice || minMileage || maxMileage\n          ? `${carsEndpoint}?page=1&limit=25${make ? `&make=${make}` : ''}`\n          : `${carsEndpoint}?page=${page}&limit=${carsPerPage}${\n              make ? `&make=${make}` : ''\n            }`\n      );\n      if (!filterArray(response.data).length) {\n        toast.warning('No data');\n      }\n\n      setIsLoading(false);\n      if (response.data.length === carsPerPage) {\n        setIsPageLast(false);\n      } else {\n        setIsPageLast(true);\n      }\n      if (page === 1) {\n        setCars([...response.data]);\n      } else {\n        setCars([...cars, ...response.data]);\n      }\n    } catch (error) {\n      setIsLoading(false);\n      toast.error(error.message);\n    }\n  };\n\n  useEffect(() => {\n    fetchCarsData(currentPage);\n    if (isFirstRun.current) {\n      isFirstRun.current = false;\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [currentPage, make, rentalPrice, minMileage, maxMileage]);\n\n  const loadMoreHandler = () => {\n    dispatch(incrementCurrentPage());\n  };\n\n  return (\n    <S.Container>\n      <CarsList cars={filteredCars} />\n\n      {isLoading && (\n        <S.PageLoaderContainer>\n          <StyledLoader />\n        </S.PageLoaderContainer>\n      )}\n      {(isPageLast && !isLoading) || (\n        <S.LoadMoreButton onClick={loadMoreHandler}>Load more</S.LoadMoreButton>\n      )}\n    </S.Container>\n  );\n};\n\nexport default CatalogBody;\n"],"names":["Container","styled","div","_templateObject","_taggedTemplateLiteral","LoadMoreButton","Button","_templateObject2","_ref","theme","bgMain","_ref2","accentMain","PageLoaderContainer","_templateObject3","dispatch","useDispatch","currentPage","useSelector","selectCurrentPage","_useSearchParams","useSearchParams","searchParams","_slicedToArray","make","get","rentalPrice","minMileage","maxMileage","_useState","useState","_useState2","isLoading","setIsLoading","_useState3","_useState4","cars","setCars","_useState5","_useState6","filteredCars","setFilteredCars","_useState7","_useState8","isPageLast","setIsPageLast","isFirstRun","useRef","useEffect","filteredArray","filterArray","arr","length","filteredByRentalPrice","filter","item","Number","replace","_toConsumableArray","filteredByMinMileage","mileage","fetchCarsData","_asyncToGenerator","_regeneratorRuntime","mark","_callee","page","response","wrap","_context","prev","next","axios","concat","carsEndpoint","carsPerPage","sent","data","toast","warning","t0","error","message","stop","_x","apply","arguments","current","_jsxs","S","children","_jsx","CarsList","StyledLoader","onClick","incrementCurrentPage"],"sourceRoot":""}